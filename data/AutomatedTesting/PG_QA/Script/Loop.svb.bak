'USEUNIT DBLib 
'USEUNIT GlobalVars
'USEUNIT WebKeywords
'USEUNIT WebObjectLib
'USEUNIT RecordSetLib
'USEUNIT LogLib
'USEUNIT OR_Enovia
'USEUNIT GlobalVars
'USEUNIT TimeLib
'USEUNIT EnoviaUtils
'USEUNIT WindowsUtility

g_strBrowserType="iexplore"

Sub ClosePopupWindow
  popupIndex = 1
  caption = Sys.Browser(g_strBrowserType).BrowserWindow(1).WndCaption
  If Left( caption, 5 ) = "3DEXP" Then
    popupIndex = 0
  End If
  Log.Message( "Closing Window Index: " & popupIndex & " with Caption " & Sys.Browser(g_strBrowserType).BrowserWindow(popupIndex).WndCaption )
  Sys.Browser(g_strBrowserType).BrowserWindow(popupIndex).Keys("^[F4]")
  
End Sub

Sub Main

counter = 1
lastJVM = 11


For counter = 1 To lastJVM
      
      Call CreateEnvironment("Probe", "plmprod", False, "Performance Probe", False, "Performance")
      
      ' Choose JVM and Login
      Call Enovia_LaunchEnovia("plmprod-landing")
      Call Enovia_ChooseJVM(counter)
      Call Enovia_Login("plmperf1")
      Call Enovia_clickOK()
            
      ' Click Projects Tab
      OR_EnoviaSearch_Projects = Array("EVALUATEXPATH",".//*[@id='pvChannelTabs']/table/tbody/tr/td[3]/table/tbody/tr/td[1]", "") 
      Set objProjects = objGetObject(OR_EnoviaSearch_Projects,"","") 
      objProjects.Click
      
      aqPerformance.Start("Projects List Loaded")
           
      ' Wait for Project List to appear on screen 
      OR_EnoviaPDT_ProjectList = Array("WEBOBJECT", "ObjectType~contentText~VisibleOnScreen", "Cell~Project Space~True", "")
      Set objProjectList = objGetObject(OR_EnoviaPDT_ProjectList,"","")
      
      Call LogPerformance("Projects List Loaded", False, "")
      
      ' Click on Desired Project (in this case: Beauty Hair Care Process Validation)
      'OR_EnoviaPDT_SelectProject = Array("WEBOBJECT", "ObjectType~contentText~VisibleOnScreen", "Link~BEAUTY HAIR CARE PROCESS VALIDATION~True", "")
      'Set objPickProject = objGetObject(OR_EnoviaPDT_SelectProject,"","")
      'objPickProject.Click
      
      ' Click on Desired Project (in this case: Test Performance Benchmarking)
      OR_EnoviaPDT_SelectProject = Array("WEBOBJECT", "ObjectType~contentText~VisibleOnScreen", "Link~TEST PERFORMANCE BENCHMARKING~True", "")
      Set objPickProject = objGetObject(OR_EnoviaPDT_SelectProject,"","")
      objPickProject.Click
      
      aqPerformance.Start("Selected Project Details Loaded")
      ' Wait for desired Project Details to appear on screen
      OR_EnoviaSearch_ProdDetails = Array("WEBOBJECT", "ObjectType~contentText~VisibleOnScreen", "Panel~Project Status~True", "")
      Set objProdDetails = objGetObject(OR_EnoviaSearch_ProdDetails,"","")     
      Call LogPerformance("Selected Project Details Loaded", False, "")
      
      ' Click on Categories button
      OR_EnoviaPDT_Categories = Array("WEBOBJECT", "ObjectType~ObjectIdentifier~VisibleOnScreen", "Image~iconActionSmallReturnToFacets_png~True", "")
      Set objCategories = objGetObject(OR_EnoviaPDT_Categories,"","")
      objCategories.Click
      
      ' Click on the People button
      OR_EnoviaPDT_PeopleBtn = Array("WEBOBJECT", "ObjectType~contentText~VisibleOnScreen", "Label~People~True", "")
      Set objPeopleBtn = objGetObject(OR_EnoviaPDT_PeopleBtn,"","")
      objPeopleBtn.Click
      
      aqPerformance.Start("Member List Loaded")     
      ' Wait for Member List to appear on screen
      OR_EnoviaPDT_MemberList = Array("WEBOBJECT", "ObjectType~contentText~VisibleOnScreen", "Link~Member~True", "")
      Set objMemberList = objGetObject(OR_EnoviaPDT_MemberList,"","")     
      Call LogPerformance("Member List Loaded", False, "")
      
      ' Launch Find Product Data Search
        Call Enovia_ExecuteFindProdDataSearch() 
        aqPerformance.Start( "Find Product Data Search Window Opened" )
        Log.Message("before Find Prod")
        Set objFindSplash = objGetObject(OR_EnoviaSearch_SplashGraphic, g_SearchPageURL, "300000")
        Log.Message("after Find Prod")     
        Call LogPerformance("Find Product Data Search Window Opened", False, "")
        Call ClosePopupWindow()
      
        ' Launch Full Text Search 
        Call Enovia_FullTextSearch()
        aqPerformance.Start( "Full Text Search Window Opened" )
        Log.Message("before FT")
        Set objFindSplash = objGetObject(OR_EnoviaSearch_SplashGraphic, g_SearchPageURL, "300000")
        Log.Message("after FT")     
        Call LogPerformance("Full Text Search Window Opened", False, "")
        Call ClosePopupWindow()
        
        Call WriteRunLog(g_runLog)       
      
   
       counter = counter + 1
       Next

End Sub

Sub Test1
  Call Enovia_OpenPlusMenu(OR_EnoviaMenu_ProductSpecificationLnk, OR_EnoviaMenu_CreateVILnk)
End Sub

Sub Test2
      ' Click on "Named Search" drop down button
      OR_EnoviaPDT_NamedSearch = Array("WEBOBJECT", "ObjectType~contentText~VisibleOnScreen", "Label~Named Search~True", "")
      Set objNamedSearch = objGetObject(OR_EnoviaPDT_NamedSearch,"","")
      objNamedSearch.Click
      
      ' Product Specifications>Find Product Data...
      OR_EnoviaPDT_ProductSpecs = Array("WEBOBJECT", "ObjectType~contentText~VisibleOnScreen", "Label~Product Specifications~True", "") 
      Set objProdSpecs = objGetObject(OR_EnoviaPDT_ProductSpecs,"","")
      objProdSpecs.Click
      
      OR_EnoviaPDT_FindProdData = Array("WEBOBJECT", "ObjectType~contentText~VisibleOnScreen", "Label~Find Product Data...~True", "")
      Set objProdData = objGetObject(OR_EnoviaPDT_FindProdData,"","")
      
      Call LogPerformance(FindProdData)

End Sub