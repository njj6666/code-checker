'USEUNIT DBLib
'USEUNIT ExcelLib
'USEUNIT GlobalVars
'USEUNIT LogLib
'USEUNIT WebKeywords
'USEUNIT WebObjectLib
'USEUNIT WindowsUtility
'USEUNIT OR_Enovia
'USEUNIT OR_CSS
'USEUNIT StringLib
'USEUNIT TR_EnoviaUtils
'USEUNIT CSS_OBJClass

'Function Enovia_LaunchEnovia(Environment) as Xiaoji
'need to be added in odbc 
Function CSS_LaunchCSS()

  ' Kill all processes before starting a new. Sometimes process can be stuck in background
  Call CloseAllBrowserProcesses()
  ' Fetch app url  
  'g_strURL = GetURL(sEnv)  'as Xiaoji
  g_strURL="http://adln9213.na.pg.com/"
  Call TR_EnoviaUtils_LaunchBrowser()
  'Call LogTransaction("TR_EnoviaUtils_LaunchBrowser", "IE Launched") as Xiaoji

End function

Function CSS_Login(Identifier)  'as Xiaoji
'Function Enovia_Login(arrCreds)
  On Error Resume Next

  ' Fetch Application Credentials
  'Dim arrCreds,arrGetObj,objUserName,objPassword,objLogin
  Dim arrCreds
  'arrCreds = GetCredentials(Identifier)  'as Xiaoji
  
  'Get username textbox and input
  Set objUserName = objGetObject(OR_CSSLogin_UserNameEdt,"",30000)
  'objUserName.SetText(arrCreds(0))
  objUserName.SetText("ab7918")

  'Set objPassword = objGetObject(arrGetObj,g_CSSHomePage_URL,30000)
  Set objPassword = objGetObject( OR_CSSLogin_PasswordEdt,"",30000)
  'objPassword.SetText(arrCreds(1))
  objPassword.SetText("Css1tst1")
  
  
  'Call LogTransaction("TR_EnoviaUtils_Login", "EnoviaCredentialsLogin")  'as Xiaoji
  
  If Err.Number = 0 Then
    CSS_Login = True
  Else
    CSS_Login  = False
  End If

  Set objUserName = nothing
  Set objPassword = nothing
  Set objLogin=nothing

End Function
'*************modify by lene 26,09,2017
Function CSS_clickLogin()
  On Error Resume Next
  
 arrGetObj = OR_CSSLogin_SubmitBtn 
  Set objLogin = objGetObject(arrGetObj,g_CSSHomePage_URL,30000)
  objLogin.Click()
  'aqPerformance.Start("Login Complete")
  'Set objtext = objGetObject(OR_EnoviaHomepage_Responsibility,"","")  
  'Call LogPerformance("Login Complete", False, "")
End Function

'*******Created By Marvin 
g_strBrowserType = c_IExplorer
Function CSS_LoginNoSelectRole(identifier,environment)
'g_strBrowserType = c_IExplorer

g_strURL = GetURL(environment)
CSS_LaunchCSS()
CSS_SwitchToEnterpriseMode(objGetPage(g_strURL))
CSS_Login(identifier)

'Set obj = objGetObject(OR_EnoviaHomePage_3D,"",30000)
'Call aqObject.CheckProperty(obj, "contentText", cmpEqual, "title")
AqUtils.Delay(15000)
End Function 

Function CSS_SwitchToEnterpriseMode(objBrowser)
AqUtils.Delay(2000)
objBrowser.Keys("~t")
AqUtils.Delay(2000)
objBrowser.Keys ("r")
AqUtils.Delay(2000)
objBrowser.Keys ("[Enter]")
AqUtils.Delay(5000)
End Function 

Function CSS_Logout
On Error Resume Next
  CSSLogout.Click
End Function 