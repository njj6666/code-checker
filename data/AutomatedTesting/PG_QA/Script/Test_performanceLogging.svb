'USEUNIT EnoviaPDT_ValidationUtils
'USEUNIT GlobalVars
'USEUNIT OR_Enovia
'USEUNIT WebObjectLib
'USEUNIT WebKeywords
'USEUNIT EnoviaPDT_PDTUtils
'USEUNIT EnoviaPDT_ValidateParts

sub test1()
  g_strBrowserType = "iexplore"
  Call EnoviaPDT_NavigateTabsAndLinks("","IP Classes")
  
  'Call EnoviaPDT_WaitForBody("IP Security Settings","IP Classes")
End Sub 

sub test()   
PartType = "Affected Finished Product Part List"
g_strBrowserType = "iexplore"
g_pdt_aCategoriesTabs = EnoviaPDT_GetTabsAndLinks(PartType)

    For j = 0 to UBound(g_pdt_aCategoriesTabs)
      LinkName = g_pdt_aCategoriesTabs(j,0)
      TabName  = g_pdt_aCategoriesTabs(j,1)
      
      GcasCode = EnoviaPDT_GetGcasCode()
      
      If LinkName = "Action Bar" Or LinkName = "Attributes" And PartType <> "Virtual Intermediate" Then
        ' Product data summary link is gcas code 
        tempLinkName = GcasCode
        ' For attributes link tab name is the same
        If LinkName = "Attributes" then
          TabName = LinkName
        End If
      Else
        tempLinkName = LinkName
      End If
      
      ' some of the tabs or links can be ignored, check if it exist in ignore list
      If EnoviaPDT_CheckIgnoreList(TabName) = False Then
        If Not EnoviaPDT_NavigateTabsAndLinks(tempLinkName,TabName) Then
          sErrorMessage = "Unable to find Category link: "&tempLinkName&" Or Tab: "&TabName&" For part type: "&PartType&""
          Log.Warning(sErrorMessage)
        Else
          ' Capture perfomance timing for opening category or a tab
          sPageName = ""
          If LinkName = "Attributes" Then
            sPageName  = LinkName
          ElseIf LinkName <> "" And LinkName <> "Action Bar" Then
            If j = UBound(g_pdt_aCategoriesTabs) Then
              sPageName  = LinkName
            ElseIf g_pdt_aCategoriesTabs(j+1,1) = "" Then
              sPageName  = LinkName
            ElseIf g_pdt_aCategoriesTabs(j+1,1) <> "" Then
              sPageName = g_pdt_aCategoriesTabs(j+1,1)
            End If
          ' Need to check that we didn't open category in last round, if we did, we shouldn't capture 
          ' timing for tab since it is already open and perfomance has been captured.
          ElseIf LinkName = "" And g_pdt_aCategoriesTabs(j,1) <> "" Then
            If g_pdt_aCategoriesTabs(j-1,0) = "" Or g_pdt_aCategoriesTabs(j-1,0) = "Attributes" Then
              sPageName = g_pdt_aCategoriesTabs(j,1)
            ElseIf g_pdt_aCategoriesTabs(j-1,0) = "Action Bar" And g_pdt_aCategoriesTabs(j,1) = "Copy" Then
              sPageName = g_pdt_aCategoriesTabs(j,1)
            End If
          Else 
            sPageName = ""
          End If
          
          If LinkName <> "" Then
            g_pdt_CurrentCategory = LinkName
          End If
          
          Log.Message(LinkName&"-"&g_pdt_aCategoriesTabs(j,1))
          Log.Message(sPageName)
          
          Call EnoviaPDT_WaitForBody(g_pdt_CurrentCategory,sPageName)
          
          If TabName = "Copy" Then
            Call click(OR_EnoviaPDT_CancelBtn,g_CopyPage_URL,1000)
          End If
        End If
      End If
    Next
End Sub



