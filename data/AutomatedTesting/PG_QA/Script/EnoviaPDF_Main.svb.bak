'USEUNIT EnoviaPDF_Vars
'USEUNIT EnoviaPDF_Utils
'USEUNIT EnoviaPDF_ExcelUtils
'USEUNIT LogLib
'USEUNIT GlobalVars
'USEUNIT EnoviaUtils
'USEUNIT WindowsUtility
'USEUNIT EnoviaPDF_ValidateEngine

'Start PDf's views
Function PDF_Main(sEnv, nBuildNumber)   
  Dim PDFViews_Driver , sIsRunValidation
  Call CreatePdfLocalfolderStructure()   
  PDFViews_Driver = Excel_ReadExcelSheet(aqFileSystem.GetFolderInfo(aqFileSystem.GetCurrentFolder).ParentFolder.ParentFolder.Path&"Files\PDFView\Order_PDF.xls", "PDFSource5")
  For i = 0 to UBound(PDFViews_Driver) 
      sIsRunValidation = PDFViews_Driver(i,5)
      If sIsRunValidation = "Y" Then
          Call CreateEnvironment("Enovia PDF Views Regression", sEnv, true, "Enovia PDF Views Regression", false, "Regression")          
          Call Enovia_LaunchEnovia(g_regLog.Environment)  
          If Not Enovia_Login(g_PDFViewsEngineUserName) Then
              Log.Error("Cannot login into Enovia!")
              Runner.Stop
          End If 
          Call MaximizeAllWindows()
          Call Enovia_clickOK()  
          g_pdf_sCurrentTestCase = Trim(PDFViews_Driver(i,0))
          g_pdf_sCurrentPartShortName = Trim(PDFViews_Driver(i,1))
          g_pdf_sCurrentPartType = Trim(PDFViews_Driver(i,2))
          g_pdf_sCurrentViewType = Trim(PDFViews_Driver(i,3))
          g_Pdf_sGcasCode = Trim(PDFViews_Driver(i,4))
          g_Pdf_sCurrentInputExcelpath = Trim(PDFViews_Driver(0,7))&Trim(PDFViews_Driver(i,6))           
          Log.AppendFolder("Part Type: "&g_pdf_sCurrentPartType)
          g_Pdf_CurrentPDFfilePathAndName = g_sPdfFileDownloadpath&g_pdf_sCurrentPartShortName&"_"&g_Pdf_sGcasCode&"_"&g_pdf_sCurrentViewType
          g_Pdf_CurrentPDFtoExcelfilePathAndName = g_sPdfFileConvertedpath&g_pdf_sCurrentPartShortName&"_"&g_Pdf_sGcasCode&"_"&g_pdf_sCurrentViewType          
          Call PDF_ReadInputexcel() 
          Call EnoviaPDFViews_DownloadPdfView()          
          Call EnoviaPDF_ConvertPdfToExcel ()
          Call PDFCompareEngine()          
          bPassed = true                            
          Call LogTestCase("PartType:"&g_pdf_sCurrentPartType&", ViewType:"&g_pdf_sCurrentViewType&", GcasCode:"&g_Pdf_sGcasCode,g_pdf_sCurrentTestCase, "")          
          Log.PopLogFolder 
          Call CloseEnvironment()
      End If  
  Next  
End Function 