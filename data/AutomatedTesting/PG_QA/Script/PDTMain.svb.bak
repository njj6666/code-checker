'USEUNIT EnoviaPDT_CheckEditable
'USEUNIT EnoviaPDT_CreatePartFillFields
'USEUNIT EnoviaPDT_CheckDefaultValues
'USEUNIT EnoviaPDT_CheckMandatory
'USEUNIT EnoviaPDT_CheckOrder
'USEUNIT EnoviaUtils
'USEUNIT ExcelLib
'USEUNIT StringLib
'USEUNIT WindowsUtility
'USEUNIT GlobalVars
'USEUNIT OR_Enovia
'USEUNIT EnoviaPDT_PDTUtils
'USEUNIT EnoviaPDT_ValidateParts
'USEUNIT WebObjectLib

Sub Main()

  Dim PartType, PartTypeCount, RunValidations, GcasCode, Driver
  
  g_strBrowserType = "iexplore"
  
  ' Launch browser and navigate to environment URl
  Enovia_LaunchEnovia("plmtest")
  
  ' Login using identifier's creds
  blnResult = Enovia_Login("dsmregression")
  
  'Login failed, terminate test
  If Not blnResult Then
    Log.Error("Cannot login into Enovia!")
    Runner.Stop
  End If
  
  ' Role selection
  Enovia_clickOK()
  
  ' Wait for home button
  Set objHomeButton = objGetObject(EnoviaHomeButton,"",120000)

  ' Loop througt the part types
  Driver = Excel_ReadExcelSheet(aqFileSystem.GetFolderInfo(aqFileSystem.GetCurrentFolder).ParentFolder.ParentFolder.Path&"Files\PDT\Driver.xls", "Execute")
  
  For i = 0 to UBound(Driver)
    PartType = Driver(i,0)
    PartTypeCount = Driver(i,1)
    RunValidations = Driver(i,2)
    
    If PartTypeCount > 0 Then
      ' Validate Create page
      If RunValidations = "Y" Then
        blnResult = EnoviaPDT_ValidateCreatePage(PartType)
        Delay 3000
        If Not blnResult Then
          Log.Warning("Error(s) while validation create page for part type: "&PartType)
        End If
      End If
      ' Lets create as many parts that is set in Driver spreadsheet
        Log.AppendFolder("Create part: "&PartType)
        blnResult = EnoviaPDT_CreatePartAndFillFields(PartType,PartTypeCount)
        Log.PopLogFolder
        
      If blnResult = False then
        Log.Warning("Unable to create part: "&PartType)
      End If
    
      ' Run Validations for all the tabs if part creation was successful.
      If RunValidations = "Y" And blnResult Then
        Call EnoviaPDT_ValidateAllTabs(PartType, GetGcasByPartType(PartType))
      End If 
    
    End if
    
  Next
  
  EnoviaPDT_PrintAllCreatedParts()
  
  'done executing, logging off.
  Enovia_Logout()
  CloseAllWindows()
  
End Sub
