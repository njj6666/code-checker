'USEUNIT DSM_E2EUtility
'USEUNIT DSM_PDTUtility
'USEUNIT EnoviaUtils
'USEUNIT ExcelLib
'USEUNIT GlobalVars
'USEUNIT LogLib
'USEUNIT OR_DSM
'USEUNIT OR_Enovia
'USEUNIT WebKeywords
'USEUNIT WebObjectLib

'Create a new FPP on home page of Enovia, Click "+" Sign and create a new part
Sub EnoviaDSM_S05006_S_CreateFPP()
  On Error Resume Next
  Dim objCurObj, strPDTNumber, strStepComm
  
  'Create FPP as predefined attribute value 
  Call EnoviaDSM_CreatePDTfromHomePage("S5006_FPP")
  
  '****Check result and InsertValue into excel 
  strStepComm = "Create FPP product data"
  aqPerformance.Start( "Product Data Home Page Loaded" )
  Set objCurObj = objGetObject(OR_EnoviaHomePage_HeaderName,"","")
  Call LogPerformance("Product Data Home Page Loaded", False, "") 
  If objCurObj.Exists Then 
    bPassed = True
    'get the new FPP Number
    strPDTNumber = aqObject.GetPropertyValue(objCurObj,"textContent")
    'Log the result 
    strStepComm = "Successed: " & strStepComm & ": " & strPDTNumber
    Log.Event strStepComm
    'Record PDT Number in the excel as the result
    Call Excel_InsertValue(g_strOutputDataFilePath,"001-012","S5006_FPP-S5-001",strPDTNumber)
    else
    bPassed = False
    strStepComm = "Failed: " & strStepComm
    Log.Event strStepComm
  End If
  
  Call LogStepDataDSM("Create FPP Product Data", bPassed, strStepComm, sInfo)
  
  'Clean up
  Enovia_ClearVariable objCurObj
  Enovia_ClearVariable strPDTNumber
  Enovia_ClearVariable strStepComm
  Enovia_ClearVariable bPassed  
End Sub 

'Edit FPP Attributes
Sub EnoviaDSM_S05006_S_EditFPPAttribute()
  On Error Resume Next
  Dim objCheck, arrCheckPoint
  '***Click Edit button to update multiple FPP Attributes
  Call EnoviaDSM_EditPDTMultiAttrs(Array_EnoviaPDTAtt_S5006_FPP,"EditPDTAttr","S5006_FPP",5)

  'Verify and Log the result
  'Using the attribute value as checkpoint
  aqPerformance.Start( "Save Product Data Attributes" )
  arrCheckPoint = Array("WEBOBJECT","ColumnIndex~RowIndex~ObjectIdentifier","1~9~33","")
  Call LogPerformance("Save Product Data Attributes", False, "")
  bFlag = VerifyText(arrCheckPoint, "", "", "CONTENTTEXT", "No")
  strStepComm = "Edit FPP Attribute" 
  If bFlag Then 
    bPassed = True
    strStepComm = "Successed: " & strStepComm
    Log.Event strStepComm
    else
    bPassed = False
    strStepComm = "Failed: " & strStepComm
    Log.Event strStepComm
  End If
  Call LogStepDataDSM("Edit FPP Attribute", bPassed, strStepComm, sInfo) 
  
  'Clean up
  Enovia_ClearVariable objCheck
  Enovia_ClearVariable arrCheckPoint
  Enovia_ClearVariable bFlag
  Enovia_ClearVariable strStepComm
  Enovia_ClearVariable bPassed
End Sub 

'Create a new CUP part under FPP part
Sub EnoviaDSM_S05006_S_CreateCUPUnderFPPPart()
  On Error Resume Next
  Dim arrGetObj,strSheetName,strKeyWord
  '***Click Left panel BOM on part home page
  Call Click(OR_EnoviaPDTLP_Fourth,"","")
  '****Click EditAll
  Call Click(OR_EnoviaBOM_EditAll,"","")
  'Check the FPP part
  value = Excel_SearchValue(g_strOutputDataFilePath,"001-012","S5006_FPP-S5-001")
  Call ClickCheckboxInTreeTable(value,"")
  'Add New Data
  'Click add part
  Call Click(OR_EnoviaBOM_AddPart,"","")
  'Click Add new data
  Call Click(OR_EnoviaBOM_AddNewData,"","")
  
  '****Fill the cup option values
 
  '***Get attribute value from predefined excel as the input
  arrPDTValues = Excel_SearchPDTValue(g_strInputDataFilePath,"S5006_CUP")  
  
  '***Fill attribute into the create page and click done
  Call EnoviaDSM_CreateProductData(arrPDTValues)
  

  


  'Insert CUPNumber to excel
  strSheetName = "001-012"
  arrGetObj = arrGetObjInfoFromXL("DSM_BOMPage","CUP-S5-001")
  Set obj = objGetObject(arrGetObj,"","")
  value = aqObject.GetPropertyValue(obj,"textContent")
  If obj.Exists Then
  log.Message "Steps5:"&name&" is created successfully"
  Else
  log.Message "Steps5:"&name&" is not created successfully"
  End If
  Call Excel_InsertValue(g_strOutputDataFilePath,"001-012","S5006_CUP-S5-001",value)
  Set obj = Nothing
End Sub 

