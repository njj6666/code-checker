'Read a excel sheet and return stored data object Name. 
Function Excel_ReadExcelSheet (FilePath, SheetName)
  On Error Resume Next  
  Dim objDriver, nColumnCount, arrTempArray(), arrReturnArray(), i
  Set objDriver = DDT.ExcelDriver(FilePath, SheetName, true)
  nColumnCount = objDriver.ColumnCount-1
  i = 0
  ReDim Preserve arrTempArray(999,nColumnCount)  
  While Not objDriver.EOF()
      For j = 0 to nColumnCount
          arrTempArray(i,j) = objDriver.Value(j)
      Next
      i = i+1
      DDT.CurrentDriver.Next()
  WEnd
  DDT.CloseDriver(objDriver.Name)  
  ReDim Preserve arrReturnArray(i-1,nColumnCount)  
  For n = 0 to Ubound(arrReturnArray)      
      For x = 0 to nColumnCount
          arrReturnArray(n,x) = arrTempArray(n,x)      
      Next    
  Next  
  Excel_ReadExcelSheet = arrReturnArray
End Function

 