'USEUNIT GlobalVars
'USEUNIT LogLib
'USEUNIT OR_Enovia
'USEUNIT WindowsUtility
'USEUNIT EnoviaUtils
'USEUNIT WebObjectLib
'USEUNIT EnoviaSearch_PopulateSearchModel

Dim SearchRecord

'Search for a Limited Data
'##################################################################################################################
'Function Name                : EnoviaSearch_GeneralTC17_Steps
'Description                  : TC-17_Named Search_Limit - Search for a Limited Data
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Vamsi
'Creation Date                : 8-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################

Function EnoviaSearch_GeneralTC17_Steps()

  Call LogStep("EnoviaSearch_GeneralTC17_Step1", "The Object(s) should be displayed in the Search Results Window.","")
  Call LogStep("EnoviaSearch_GeneralTC17_Step2", "The new limit should be displayed in the text box","")
  Call LogStep("EnoviaSearch_GeneralTC17_Step3", "A Warning should be displayed Warning Object Find Limit Reached The number of the results should be refined to the limit set and displayed in the Search Results Pane", "")
  Call LogStep("EnoviaSearch_GeneralTC17_Step4", "No Warning. Search Results should refresh with all the related Results", "")

  Call LogTestCase("Search for a Limited Data", "TC-17_Named Search_Limit", "47691")
  
End Function



'##################################################################################################################
'Function Name                : EnoviaSearch_GeneralTC17_Step1
'Description                  : In the Global Search Bar, Enter the name of the Object you want to search and click on the Search Icon.
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Vamsi
'Creation Date                : 8-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################

Function EnoviaSearch_GeneralTC17_Step1()
    
   
    
    'Create object to search data
    SearchRecord = EnoviaSearch_ReadTestCasesData("TC-17_Named Search_Limit","Search")
    Call Enovia_SearchStuff(SearchRecord)
  
    'Switching to Real time mode
    Sys.Refresh
    'Create object of Switch Query Button 
    Set objSwitchQueryButton = objGetObject(OR_EnoviaSearch_SwitchQueryButton,"",3000)
    If objSwitchQueryButton.title = "Switch to RealTime Search" Then
         objSwitchQueryButton.Click () 
         Sys.Refresh
         objSwitchQueryButton.Refresh
         Call objSwitchQueryButton.WaitProperty("title","Switch to Indexed Search",7000) 
         If objSwitchQueryButton.title = "Switch to RealTime Search" Then
              Call Err.raise(63001,"EnoviaSearch_GeneralTC17_Step1","Real Time Search not changed to Indexed Search")
         End If
    End If
    Set objSwitchQueryButton = Nothing
    
    'Create object for search button
    Set SearchButton = objGetObject(OR_EnoviaSearch_TC17_Search,"",3000)
    SearchButton.click()
    aqUtils.Delay 10000,"Waiting for the page refresh after search"
    
    'Function to handle alert
    Call EnoviaSearch_AlertWindow("")  
   
End Function 


'##################################################################################################################
'Function Name                : EnoviaSearch_GeneralTC17_Step2
'Description                  : In the Search Refinement Page, Click on the Textbox near 'Limit to 100 results' and Set the limit to a number lower than the total Count of the Objects .Ex: 58017909 Limit:13
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Vamsi
'Creation Date                : 8-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################

Function EnoviaSearch_GeneralTC17_Step2()
    
    'Create object of Limit text box
    Set objLimitNumber = objGetObject(OR_EnoviaSearch_SearchLimitToChk,"",3000)
    SearchRecord = EnoviaSearch_ReadTestCasesData("TC-17_Named Search_Limit","LowerLimit")
    objLimitNumber.SetText(SearchRecord)
    Set objLimitNumber = nothing
      
End Function 


'##################################################################################################################
'Function Name                : EnoviaSearch_GeneralTC17_Step3
'Description                  : Click on the Search Icon in the Search Refinement Pane 
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Vamsi
'Creation Date                : 8-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################

Function EnoviaSearch_GeneralTC17_Step3()

    'Create object of Limit Search buttton
    Set objLimitSearchButton = objGetObject(OR_EnoviaSearch_SSearchRefreshCmd,"","")
    objLimitSearchButton.Click()
    Set objLimitSearchButton = nothing
  
    'Function to handle alert message
    Call EnoviaSearch_AlertWindow("")
    
    'Need to wait for page refresh
    aqutils.Delay 10000,"Page Refreshing"
    
    'Create object to get the rowcount of records displayed
    Set objLimitRowCount=objGetObject(OR_EnoviaSearch_TC17_Rows,"",7000)
    nRowCount = objLimitRowCount.rowCount
    Set objLimitRowCount = nothing
    SearchRecord = EnoviaSearch_ReadTestCasesData("TC-17_Named Search_Limit","LowerLimit")    
    nActualRowCount = nRowCount - 1
    If CInt(SearchRecord) < CInt(nActualRowCount) Then
      Call Err.Raise(60001, "EnoviaSearch_GeneralTC17_Step2", "The row count did not match what was set.")
    End If

End Function


'##################################################################################################################
'Function Name                : EnoviaSearch_GeneralTC17_Step4
'Description                  : Set the limit to a number higher than the total count of the Objects. Limit:100 
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Vamsi
'Creation Date                : 8-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################

Function EnoviaSearch_GeneralTC17_Step4()

  'Create object of Limit text box
  Set objLimit = objGetObject(OR_EnoviaSearch_SearchLimitToChk,"",3000)
  objLimit.Click()
  SearchRecord = EnoviaSearch_ReadTestCasesData("TC-17_Named Search_Limit","UpperLimit")
  objLimit.SetText(SearchRecord)
  Set objLimit = nothing
    
  'Create object of Limit Search buttton
  Set objLimitSearchButton=objGetObject(OR_EnoviaSearch_SSearchRefreshCmd,"","")
  objLimitSearchButton.Click()
  Set objLimitSearchButton = nothing
  
  'Need to wait for page refresh
  aqutils.Delay 10000,"Page Refreshing after search"
  
  'Create object for alert
   Set objAlert = objGetObject(OR_EnoviaSearch_AlertWnd,"",1000)
   If (objAlert is Nothing)=False Then
      Call Err.raise (70063,"EnoviaSearch_PeripheralTC17_Step4","Alert Exists")
   End If
   
   Set objLimit = objGetObject(OR_EnoviaSearch_SearchLimitToChk,"",7000)
   objLimit.SetText("100")
   Set objLimit = nothing
   
End Function