'USEUNIT GlobalVars	
'USEUNIT LogLib	
'USEUNIT OR_Enovia	
'USEUNIT WindowsUtility	
'USEUNIT EnoviaUtils	
'USEUNIT WebObjectLib	
'USEUNIT EnoviaSearch_PopulateSearchModel
'USEUNIT EnoviaUtils
	
Function EnoviaSearch_PeripheralTC21_Steps()	

  Call LogStep("EnoviaSearch_PeripheralTC21_Step1", "A dropdown with various commands(Like-Named Search, My Favourite Searches, Full Text Search..etc) should appear","")
	Call LogStep("EnoviaSearch_PeripheralTC21_Step2", "A new window with 'Search Refinement Pane' and 'Search Results Pane' should pop up.","")
	Call LogStep("EnoviaSearch_PeripheralTC21_Step3", "The name should be displayed in the Search Refinement Pane.","")
	Call LogStep("EnoviaSearch_PeripheralTC21_Step4", "The default value is set to Release. A small box should open with a Textbox, to type in the 'State'.","")
	Call LogStep("EnoviaSearch_PeripheralTC21_Step5", "The results should get refined in the Dropdown menu.","")
	Call LogStep("EnoviaSearch_PeripheralTC21_Step6", "The State(s) should get selected and displayed in the 'Search Refinement' Pane.","")
	Call LogStep("EnoviaSearch_PeripheralTC21_Step7", "The Object(s) with the Selected Name and State should get refined in the Search Results Page.","")
	Call LogStep("EnoviaSearch_PeripheralTC21_Step8", "The Object(s) are selected","")
	Call LogStep("EnoviaSearch_PeripheralTC21_Step9", "A new window 'Mass Promote/Demote Error Report.  Error Report Dialog' opens with the Number of object(s) that were successfully promoted and the Number of Object(s) that failed. The Miscellaneous Errors are displayed with the Type Name Revision and Description(Reason it failed)","")
  Call LogStep("EnoviaSearch_PeripheralTC21_Step10", "The  'Mass Promote/Demote Error Report.  Error Report Dialog' window closes and in the Find Product Data window, the State of the successfully promoted Object(s) changes to the next state","")
	Call LogStep("EnoviaSearch_PeripheralTC21_Step11", "The Object(s) are selected","")
  Call LogStep("EnoviaSearch_PeripheralTC21_Step12", "A new window 'Mass Promote/Demote Error Report.  Error Report Dialog' opens with the Number of object(s) that were successfully Demoted and the Number of Object(s) that failed. The Miscellaneous Errors are displayed with the Type Name Revision and Description(Reason it failed)","")
  Call LogStep("EnoviaSearch_PeripheralTC21_Step13", "The  'Mass Promote/Demote Error Report.  Error Report Dialog' window closes and in the 'Find Product Data' window, the State of the successfully demoted Object(s) changes to the prevoius state","")
	
	Call LogTestCase("Promoting/Demoting your Search Results", "TC-21_Find Product Data_Toolbar Mass Promote/Demote","47713")
	
End Function	

'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC21_Step1
'Description                  : Drop down of various commands appears
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 9-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
	
Function EnoviaSearch_PeripheralTC21_Step1()	
 
    'Create object for delete saved name
    Set objDeleteSaved = objGetObject(OR_EnoviaSearch_TC19_DeleteSavedName,"",3000)
    objDeleteSaved.Click()
    Set objDeleteSaved = nothing
    
    'Create object for Search product spec
    Set objEnoviaSearchProductSpec = objGetObject(OR_EnoviaSearchProductSpec_SearchDrp,"",3000)
    If objEnoviaSearchProductSpec.VisibleOnScreen = False Then
      Call Err.raise(64994,"EnoviaSearch_PeripheralTC21_Step1","A dropdown with various commands shown")
    End If
    Set objEnoviaSearchProductSpec = nothing
    
End Function	
	
'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC21_Step2
'Description                  : Find data product page opens
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 9-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
			
Function EnoviaSearch_PeripheralTC21_Step2()	
   
    'create object for EnoviaSearchFindProdData
    Set objEnoviaSearchFindProdData = objGetObject(OR_EnoviaSearchFindProdData_SearchDrop,"",3000)
    If objEnoviaSearchFindProdData.VisibleOnScreen = True Then
      objEnoviaSearchFindProdData.Click()
    Else    
      'create object for SearchProductSpec
      Set objEnoviaSearchProductSpec = objGetObject(OR_EnoviaSearchProductSpec_SearchDrp,"",3000)
      objEnoviaSearchProductSpec.Click()
      objEnoviaSearchFindProdData.Click()
    End If
    Set objEnoviaSearchProductSpec = nothing
    Set objEnoviaSearchFindProdData = nothing
    
    'create object for search edit
    Set objSearchEdtRecord = objGetObject(OR_EnoviaSearchFindProdData_SearchEdt,g_SearchPageURL,3000)
    If objSearchEdtRecord.Exists = False Then
      Call Err.raise (64995,"EnoviaSearch_PeripheralTC21_Step2","Fail-FindProdData NOT opened")
    End If
    Set objSearchEdtRecord = nothing 
     
End Function	
	

'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC21_Step3
'Description                  : search a record
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 9-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
				
Function EnoviaSearch_PeripheralTC21_Step3()	
    
    'Maximize the search window
    Call MaximizeByCaption("Search - Internet Explorer")
    'Create object for Name/Number
    Set objNameNum = objGetObject(OR_EnoviaSearchFindProdData_NameNumberPnl,g_SearchPageURL,3000)
    objNameNum.Click()
    Set objNameNum = nothing 
    
    'Create object for text area
    Set objNameText = objGetObject(OR_EnoviaSearch_TC21_State_Text,g_SearchPageURL,"")
    SearchRecord = EnoviaSearch_ReadTestCasesData("TC-21_Find Product Data_Toolbar Mass Promote/Demote","Search")
    objNameText.Keys(SearchRecord)
    Set objNameText = nothing   
    
End Function	
	
'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC21_Step4
'Description                  : Check the data is exported correctly or not
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 9-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
			
Function EnoviaSearch_PeripheralTC21_Step4()	
    
    'Create object for state Ellipsis
    Set objState = objGetObject(OR_EnoviaSearch_TC21_State_TxtNode,g_SearchPageURL,4000)
    Set oStateBtn = objState.FindChild(Array("ObjectType","ObjectIdentifier"),Array("Button","..."),1)
    If oStateBtn.Exists Then
      oStateBtn.Click()
    End If
    'Set objState = objGetObject(OR_EnoviaSearch_TC21_State_Ellipsis,g_SearchPageURL,4000)
    Set objState = nothing  
    Set oStateBtn = nothing
      
End Function	

'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC21_Step5
'Description                  : See special characters
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 9-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
			
Function EnoviaSearch_PeripheralTC21_Step5()	
    
   'Create object for state preliminary
    Set objSelectState = objGetObject(OR_EnoviaSearch_TC21_State_Preliminary,g_SearchPageURL,4000)
    objSelectState.Click()
    Set objSelectState = nothing  

End Function	

'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC21_Step6
'Description                  : open multi column page
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 9-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
			
Function EnoviaSearch_PeripheralTC21_Step6()	
  
    'Create object for state select
    Set objSelect = objGetObject(OR_EnoviaSearch_TC21_State_Select,g_SearchPageURL,3000)
    objSelect.Click()
    Set objSelect = nothing  

End Function	
	
'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC21_Step7
'Description                  : Select values under the 1st Dropdown
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 9-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
				
Function EnoviaSearch_PeripheralTC21_Step7()	
  
   'Create object for search refresh command
    Set objSearchRefreshCmd = objGetObject(OR_EnoviaSearch_SSearchRefreshCmd,g_SearchPageURL,3000)
    objSearchRefreshCmd.Click()
    Set objSearchRefreshCmd = nothing

End Function	
	
'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC21_Step8
'Description                  : Select values under the 2nd Dropdown
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 9-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
				
Function EnoviaSearch_PeripheralTC21_Step8()	
 
   'Create object for selecting a record
   Set objSelectRecord = objGetObject(OR_EnoviaSearch_TC18_SelectRecord,g_SearchPageURL,3000)
   objSelectRecord.Click()
   Set objSelectRecord = nothing
	
End Function	
	
'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC21_Step9
'Description                  : Select values under the 1st Dropdown
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 9-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
				
Function EnoviaSearch_PeripheralTC21_Step9()	
 
    'Create object for toolimage
     Set objToolImage = objGetObject(OR_EnoviaSearch_TC7_ToolImage,g_SearchPageURL,3000)
     objToolImage.Click()
     Set objToolImage = nothing
     
     'Create object for toolimage
     Set objPromote = objGetObject(OR_EnoviaSearch_TC7_MassPromoteButton,g_SearchPageURL,3000)
     objPromote.Click()
     Set objPromote = nothing 
	
     'Create an object for updated error page report    
     Set oMesg =objGetObject(OR_EnoviaSearch_TC21_Promote_Demote_Page_Error_Mesg,g_ErrorReporting_URL,20000)
     If oMesg.VisibleOnScreen = False Then
      Call Err.raise(64996,"EnoviaSearch_PeripheralTC21_Step10","Error Report Dialog either NOT opened or Number of object(s) that are NOT successfully Promoted/Demoted ")
     End If
     Set objMesg = Nothing
     
     
End Function	
	
'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC21_Step10
'Description                  : click on done
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 9-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
				
Function EnoviaSearch_PeripheralTC21_Step10()	
 
    'Create object for toolimage
     Set objClose = objGetObject(OR_EnoviaSearch_TC7_CloseButton,g_ErrorReporting_URL,3000)
     objClose.Click()
     Set objClose = nothing
     
     'Create object for Table Header
     Set objTableHeader = objGetObject(OR_Enovia_MainPage_Table_Header,g_SearchPageURL,3000)
    
     ' retrun the col no of "state" column in  
     Set objState_Label=objTableHeader.FindChild("contentText","State",6)
     nColumnIndex=cInt((objState_Label.ColumnIndex)/2)
     
     Set objState_Label = Nothing
     Set objTableHeader = Nothing
     
     'Create object for Table Contents
     Set objBodyTable = objGetObject(OR_Enovia_MainPage_Table_Contents,g_SearchPageURL,3000)
     
     bSrch = True
     'Check the contents are In Work status after Promotion
     For j = 1 to objBodyTable.RowCount-1
      If  Ucase(objBodyTable.Cell(j,nColumnIndex).innerText) <> "LOCKED" Then
        bSrch = False
        Exit For
      End If  
     Next
     
     Set objBodyTable = Nothing
      
     'Check for the False value    
     If bSrch = False Then
      Call Err.raise(64997,"EnoviaSearch_PeripheralTC21_Step11","2 or 2 Promoted entries are not in 'Review' State ")
     End If  
	
End Function	

'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC21_Step11
'Description                  : check the sorting order
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 9-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
			
Function EnoviaSearch_PeripheralTC21_Step11()	
     
    'Create object for toolimage
     Set objToolImage = objGetObject(OR_EnoviaSearch_TC7_ToolImage,g_SearchPageURL,3000)
     objToolImage.Click()
     Set objToolImage = nothing
     
End Function	

'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC21_Step12
'Description                  : check the sorting order
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 9-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
			
Function EnoviaSearch_PeripheralTC21_Step12()	
    
    'Create object for demote
    Set objDemote = objGetObject(OR_EnoviaSearch_TC7_MassDemoteButton,g_SearchPageURL,3000)
    objDemote.Click()
    Set objDemote = nothing
    
    'Create object for promote page
    Set objMesg =objGetObject(OR_EnoviaSearch_TC21_Promote_Demote_Page_Error_Mesg,g_ErrorReporting_URL,3000)
    If objMesg.VisibleOnScreen = False Then
      Call Err.raise(64998,"EnoviaSearch_PeripheralTC21_Step12","Error Report Dialog either NOT opened or Number of object(s) that are NOT successfully Demoted ")
    End If
    Set objMesg = Nothing

End Function	

'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC21_Step13
'Description                  : check the sorting order
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 9-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
			
Function EnoviaSearch_PeripheralTC21_Step13()	
    
  'Create object for toolimage
   Set objClose = objGetObject(OR_EnoviaSearch_TC7_CloseButton,g_ErrorReporting_URL,"")
   objClose.Click()
   Set objClose = nothing
     
   'Create an Object for Table Header
   Set objTableHeader = objGetObject(OR_Enovia_MainPage_Table_Header,g_SearchPageURL,3000)
     
   Set objState_Label=objTableHeader.FindChild("contentText","State",6)
   nColumnIndex=cInt((objState_Label.ColumnIndex)/2)
     
   Set objState_Label = Nothing
   Set objTableHeader = Nothing
     
   'Create an Object for Table Body
   Set objBodyTable = objGetObject(OR_Enovia_MainPage_Table_Contents,g_SearchPageURL,3000)
    
   'Check for the Pending status in State Column
   bSrch = True
     
   For j = 1 to objBodyTable.RowCount-1
    If  Ucase(objBodyTable.Cell(j,nColumnIndex).innerText) <> "PRELIMINARY" Then
      bSrch = False
      Exit For
    End If  
   Next
          
   If bSrch = False Then
    Call Err.raise(64999,"EnoviaSearch_PeripheralTC7_Step7","One or more Demoted entries are not in 'Pending' State ")
   End If  
        
   Set objBodyTable = Nothing
     
End Function	


