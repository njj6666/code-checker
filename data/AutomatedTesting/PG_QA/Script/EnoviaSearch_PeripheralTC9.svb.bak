'USEUNIT GlobalVars	
'USEUNIT LogLib	
'USEUNIT OR_Enovia	
'USEUNIT WindowsUtility	
'USEUNIT EnoviaUtils	
'USEUNIT WebObjectLib	
'USEUNIT EnoviaSearch_PopulateSearchModel

Dim SearchSaveAsName

Function EnoviaSearch_PeripheralTC9_Steps()	
	
	Call LogStep("EnoviaSearch_PeripheralTC9_Step1", "A dropdown with various commands(Like-Named Search, My Favourite Searches, Full Text Search..etc) should appear","")
	Call LogStep("EnoviaSearch_PeripheralTC9_Step2", "A new window with Search Refinement Pane and Search Results Pane should pop up","")
	Call LogStep("EnoviaSearch_PeripheralTC9_Step3", "The Search Results Pane should refresh and all the objects which contain the Name(s)/Phrase(s) that was typed will be displayed. Ex:  All the Objects which contain the Phrase Test in their Specification/Attributes/Docs should be displayed.","")
	Call LogStep("EnoviaSearch_PeripheralTC9_Step4", "A Save as Window should open with a Text box for typing the name and Radio Buttons for Selecting any Previous names","")
	Call LogStep("EnoviaSearch_PeripheralTC9_Step5", "The Results should be Saved and should replace the previous Search Results with that name.","")
	Call LogStep("EnoviaSearch_PeripheralTC9_Step6", "The Search Results Pane should refresh and should display the saved results","")
	
	Call LogTestCase("Replace your Specific Search Results", "TC-09_Full Text Search_Toolbar_Save As","47701")
	
End Function	



'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC9_Step1
'Description                  : Open full searchtext page
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 8-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################

Function EnoviaSearch_PeripheralTC9_Step1()	
   
    'Create object for clicking name search
    Set objDeleteSaved = objGetObject(OR_EnoviaSearch_TC19_DeleteSavedName,"","")
    objDeleteSaved.Click()
    Set objDeleteSaved = nothing
    
    'Create object for FullSearch Text
    Set FullSearchText = objGetObject(OR_EnoviaSearch_TC13_FullSearchText_Label,"",3000)
    If FullSearchText.Exists = False Then
      'Create the object for Product Specifications
      Set objEnoviaSearchProductSpec = objGetObject(OR_EnoviaSearchProductSpec_SearchDrp,"","")
      objEnoviaSearchProductSpec.Click()
      If objFullSearchText.VisibleOnScreen = False Then
        Call Err.raise(64952,"EnoviaSearch_PeripheralTC9_Step1","dropdown with various commands shown")
      End If
     Set objEnoviaSearchProductSpec = nothing
    End If
    Set objFullSearchText = nothing
       
End Function	
	

'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC9_Step2
'Description                  : Full search text page is displayed
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 8-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
	
Function EnoviaSearch_PeripheralTC9_Step2()	
   
    'Create object for FullSearch Text
    Set objFullSearchText = objGetObject(OR_EnoviaSearch_TC13_FullSearchText_Label,"","")
    objFullSearchText.Click()
    Set objFullSearchText = nothing
    
    'Create object for Name text field
    Set objNameEdit = objGetObject(OR_EnoviaSearchFullText_SearchEdt,g_SearchPageURL,3000)
    If objNameEdit.Exists = False Then
      Call Err.raise(64953,"EnoviaSearch_PeripheralTC9_Step2","dropdown with various commands shown")
    End If
    Set objNameEdit = nothing
    
    aqUtils.Delay 10000,"Waiting for the page refresh after search."
    
End Function	
	
'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC9_Step3
'Description                  : Search the record
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 8-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
	
Function EnoviaSearch_PeripheralTC9_Step3()	
          
    'Create object for Name text field
    Set objNameEdit = objGetObject(OR_EnoviaSearchFullText_SearchEdt,g_SearchPageURL,"")
    SearchSaveAsName = EnoviaSearch_ReadTestCasesData("TC-09_Full Text Search_Toolbar_Save As","Phrase")
    objNameEdit.SetText(SearchSaveAsName)
    Set objNameEdit = nothing 
    
    'Create object for search refresh command
    Set objSearchRefreshCmd = objGetObject(OR_EnoviaSearch_SSearchRefreshCmd,g_SearchPageURL,"")
    objSearchRefreshCmd.Click()
    Set objSearchRefreshCmd = nothing
    
    aqUtils.Delay 10000,"Waiting for the page refresh after search."
    
End Function	
	
'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC9_Step4
'Description                  : SaveAs page is opened
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 8-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
		
Function EnoviaSearch_PeripheralTC9_Step4()	
   
    'Create object for Save Query button
    Set objSaveQuery = objGetObject(OR_EnoviaSearch_TC19_SavedQueries,g_SearchPageURL,3000)
    objSaveQuery.Click()
    Set objSaveQuery = nothing 
    
    'Create object for SaveAs Label
    Set objRecordSaveAs = objGetObject(OR_EnoviaSearch_TC19_SavedASRecord,g_SearchPageURL,3000)
    objRecordSaveAs.Click()
    Set objRecordSaveAs = nothing 
    
    aqUtils.Delay 10000,"Waiting for the page refresh after search."

    'Create object for radio button
    Set objSelectradioButton = objGetObject(OR_EnoviaSearch_TC19_SelectRadioButton,g_SaveAsPage_URL,3000)
    If objSelectradioButton.Exists = False Then
      Call Err.raise(64954,"EnoviaSearch_PeripheralTC9_Step4","A SaveAS Search Window not opened")
    End If
   	Set objSelectradioButton = nothing  
    
End Function	
	
'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC9_Step5
'Description                  : Cleck on done button
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 8-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
			
Function EnoviaSearch_PeripheralTC9_Step5()	

    'Create object for radio button
    Set objSelectradioButton = objGetObject(OR_EnoviaSearch_TC19_SelectRadioButton,g_SaveAsPage_URL,"")
    objSelectradioButton.Click()
    Set objSelectradioButton = nothing 
    
    'Create object for done button
    Set objDoneBtn = objGetObject(OR_EnoviaSearch_TC19_DoneButton,g_SaveAsPage_URL,"")
    objDoneBtn.Click()
    Set objDoneBtn = nothing 
    
    aqUtils.Delay 10000,"Waiting for the page refresh after search."
    
End Function	
	
'##################################################################################################################
'Function Name                : EnoviaSearch_PeripheralTC9_Step5
'Description                  : Select the saved record
'Arguments                    : NA
'Return Value                 : NA
'Author                       : Shireesha Monduti
'Creation Date                : 8-6-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
			
Function EnoviaSearch_PeripheralTC9_Step6()	
   
    'Create object for Save Query button
    Set objSaveQuery = objGetObject(OR_EnoviaSearch_TC19_SavedQueries,g_SearchPageURL,1000)
    objSaveQuery.Click()
    Set objSaveQuery = nothing
    
    'Create object for savedname
    Set objSavedRecordSelect = objGetObject(OR_EnoviaSearch_TC19_SavedRecord,g_SearchPageURL,10000)
    Sys.HighlightObject(objSavedRecordSelect)
    objSavedRecordSelect.Click()
    Set objSavedRecordSelect = nothing
    
    aqUtils.Delay 50000,"waiting for the page refresh after search"
    
    'Create object for Namesearch field
    Set objNameEdit = objGetObject(OR_EnoviaSearchFullText_SearchEdt,g_SearchPageURL,40000)
    str=objNameEdit.value
    if instr(str,SearchSaveAsName) = 0 Then
        Call Err.raise (70100,"EnoviaSearch_PeripheralTC9_Step6","Wrong record")
    End If
    Set objNameEdit = nothing
       
End Function	
