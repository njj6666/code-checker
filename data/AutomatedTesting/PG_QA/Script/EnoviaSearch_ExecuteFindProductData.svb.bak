'USEUNIT EnoviaSearch_PopulateSearchModel
'USEUNIT EnoviaSearchModels
'USEUNIT OR_Enovia
'USEUNIT LogLib
'USEUNIT WindowsUtility
'USEUNIT EnoviaUtils
'USEUNIT GlobalVars
'USEUNIT WebObjectLib
'USEUNIT EnoviaSearch_Utility
'USEUNIT EnoviaSearch_ValidateResults

Function EnoviaSearch_StartFindProductDataSearch(oModel)
  
  On Error Resume Next

  'Open the full text search window
  bPassed = true
  sErrorMsg = ""
  Call Enovia_ExecuteFindProdDataSearch() 
  If Err.Number <> 0 Then
    bPassed = false
    sErrorMsg = Err.Description
  End If
  Call LogStepData("Open find product data search window", bPassed, sErrorMsg, "")
  
  'Maximizes the find product data search window
  If g_isBlocked = false Then
    Call MaximizeAllWindows()
    aqUtils.Delay 15000, "Waiting for the page to load."
  End If
    
  'Perform the main search
  bPassed = true
  sErrorMsg = ""
  Call EnoviaFindProdData_SelectandRunFindProdSearch(oModel)
  If Err.Number <> 0 Then
    bPassed = false
    sErrorMsg = Err.Description
  End If
  Call LogStepData("Find Product Data Initial Search", bPassed, sErrorMsg, CombineSearchStrings(oModel.Common.SearchValue))
  
  'Handle the alert window if it pops up
  If g_isBlocked = false Then
    Call EnoviaSearch_AlertWindow("")
  End If
  
  'Validate the main search results
  If g_isBlocked = false Then
    If CombineSearchStrings(oModel.Common.ResultsMain) <> "$" Then
      Call EnoviaSearch_ValidateFindProductSearch(oModel,"Main") 
    End If
    If Err.Number <> 0 Then
      bPassed = false
      sErrorMsg = Err.Description
    End If    
  Else
    sErrorMsg = ""
    bPassed = true
  End If
  Call LogStepData("Validate Find Product Data Search", bPassed, sErrorMsg, oModel.Common.ResultsMain)
  
  'Perform the refined search
  If g_isBlocked = false Then
    If CombineSearchStrings(oModel.Common.ResultsRefined) <> "$" Then
      If (EnoviaSearch_ValCheck(oModel.Common.SearchValue) = True) Then
        Call EnoviaFindProdData_ExecuteType(oModel)
        Call EnoviaFindProdData_ExecuteClass(oModel)
      End If
    End If
  If Err.Number <> 0 Then
      bPassed = false
      sErrorMsg = Err.Description
    End If    
  Else
    sErrorMsg = ""
    bPassed = true
  End If
  Call LogStepData("Find Product Data Refined Search", bPassed, sErrorMsg, oModel.Common.SearchValue)
  
  'Validate the refined search results
  If g_isBlocked = false Then
    If CombineSearchStrings(oModel.Common.ResultsRefined) <> "$" Then
      Call EnoviaSearch_ValidateFindProductSearch(oModel,"Refined")
    End If 
    If Err.Number <> 0 Then
      bPassed = false
      sErrorMsg = Err.Description
    End If    
  Else
    sErrorMsg = ""
    bPassed = true
  End If
  
  Call EnoviaSearch_CloseSearchWindows()
  
  Call LogStepData("Validate Find Product Data Search", bPassed, sErrorMsg, oModel.Common.ResultsRefined)
    
End Function

'##################################################################################################################
'Function Name                : EnoviaFindProdData_SelectandRunFindProdSearch(oModel)
'Description                  : Performing the main search on Find Product Search Type
'Arguments                    : NA
'Return Value                 : Nothing
'Author                       : Geetanjali Vajrapu
'Creation Date                : 12-Jun-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
  
Function EnoviaFindProdData_SelectandRunFindProdSearch(oModel)
       
  Set objSearchVal = objGetObject(OR_EnoviaSearchFindProdData_SearchEdt,g_SearchPageURL,"")
    If IsArray(oModel.Common.SearchValue) = True Then
      sSearch = oModel.Common.SearchValue
      For i = 0 to UBound(sSearch)
        objSearchVal.Keys(sSearch(i)&"|")
      Next
    Else
    objSearchVal.SetText(oModel.Common.SearchValue)
    End If
    Set objSearchVal = Nothing
  
    Set objFindProdDataSearch = objGetObject(OR_EnoviaSearchFindProdData_Search,g_SearchPageURL,"")
    objFindProdDataSearch.Click()
    Set objFindProdDataSearch = Nothing
    
End Function

'##################################################################################################################
'Function Name                : EnoviaFindProdData_ExecuteType(oModel)
'Description                  : Performing the refined search on Find Product Search Type
'Arguments                    : NA
'Return Value                 : Nothing
'Author                       : Geetanjali Vajrapu
'Creation Date                : 12-Jun-2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
    
Function EnoviaFindProdData_ExecuteType(oModel)
       
  Set objSearchVal = objGetObject(OR_EnoviaSearchFindProdData_SearchEdt,g_SearchPageURL,"")
  
  If oModel.Common.LimitResults <> "" Then
    Set objPageSize = objGetObject(OR_EnoviaSearch_PageSize_TxtBox,g_SearchPageURL,"")
    objPageSize.SetText(oModel.Common.LimitResults)
    Set objPageSize = Nothing
  End If
      
'-------------------------------------------------------------------------------------------------------------
  
  If (EnoviaSearch_ValCheck(oModel.NameOrNumber) = True) Then
    Set objNameNum = objGetObject(OR_EnoviaSearchFindProdData_NameNumberPnl,g_SearchPageURL,"")
    objNameNum.Click()
    Set objNameNum = Nothing
    Call EnoviaSearch_DynText(objDynText,oModel.NameOrNumber)
  End If 
      
'-------------------------------------------------------------------------------------------------------------
      
  If oModel.Revision.Revision <> "" Then
    Set objRevision = objGetObject(OR_EnoviaSearchFindProdData_RevisionEdt,g_SearchPageURL,"")
    objRevision.SetText(oModel.Revision.Revision)
    Set objRevision = Nothing
  End If
  
  If oModel.Revision.Highest <> "" Then    
    Set objHighest = objGetObject(OR_EnoviaSearchFindProdData_HighestChk,g_SearchPageURL,"")
    objHighest.ClickChecked(oModel.Revision.Highest)
    Set objHighest = Nothing
  End If
  
  If oModel.Revision.ByState <> "" Then
    Set objState = objGetObject(OR_EnoviaSearchFindProdData_ByStateChk,g_SearchPageURL,"")
    objState.ClickChecked(oModel.Revision.ByState)
    Set objState = Nothing
  End If

'-------------------------------------------------------------------------------------------------------------
      
  If (EnoviaSearch_ValCheck(oModel.Common.sType) = True) Then       
    Set objType = objGetObject(OR_EnoviaSearchFindProdData_TypePnl,g_SearchPageURL,"")
    objType.Click()
    Set objType = Nothing
   
    Set objTypeSelect = objGetObject(OR_EnoviaSearchFindProdData_TypeDrp,g_SearchPageURL,2500)    
      
    If Not (objTypeSelect is Nothing) Then        
      Call EnoviaSearch_SelectList(objTypeSelect,oModel.Common.sType)      
      Set objTypeSelect = Nothing
      Set objTypeSubmit = objGetObject(OR_EnoviaSearchFindProdData_TypeBtn,g_SearchPageURL,"")
      objTypeSubmit.ClickButton()
      Set objTypeSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.Common.sType)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------
      
  If (EnoviaSearch_ValCheck(oModel.SpecSubType) = True) Then         
    Set objSubType = objGetObject(OR_EnoviaSearchFindProdData_SubTypePnl,g_SearchPageURL,"")
    objSubType.Click()
    Set objSubType = Nothing
      
    Set objSubTypeSelect = objGetObject(OR_EnoviaSearchFindProdData_SubTypeDrp,g_SearchPageURL,2500)      
      
    If Not (objSubTypeSelect is Nothing) Then      
      Call EnoviaSearch_SelectList(objSubTypeSelect,oModel.SpecSubType)      
      Set objSubTypeSelect = Nothing      
      Set objSubTypeSubmit = objGetObject(OR_EnoviaSearchFindProdData_SubTypeBtn,g_SearchPageURL,"")
      objSubTypeSubmit.ClickButton()
      Set objSubTypeSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.SpecSubType)
    End If
 End If
      
'-------------------------------------------------------------------------------------------------------------
      
  If (EnoviaSearch_ValCheck(oModel.Common.Policy) = True) Then       
    Set objPolicy = objGetObject(OR_EnoviaSearchFindProdData_PolicyPnl,g_SearchPageURL,"")
    objPolicy.Click()
    Set objPolicy = Nothing

    Set objPolicySelect = objGetObject(OR_EnoviaSearchFindProdData_PolicyDrp,g_SearchPageURL,2500)
      
    If Not (objPolicySelect is Nothing) Then
      Call EnoviaSearch_SelectList(objPolicySelect,oModel.Common.Policy)
      Set objPolicySelect = Nothing
      Set objPolicySubmit = objGetObject(OR_EnoviaSearchFindProdData_PolicyBtn,g_SearchPageURL,"")
      objPolicySubmit.ClickButton()
      Set objPolicySubmit = Nothing
    Else
     Call EnoviaSearch_DynText(objDynText,oModel.Common.Policy)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------
      
  If oModel.Common.Title <> "" Then  
    Set objTitle = objGetObject(OR_EnoviaSearchFindProdData_TitlePnl,g_SearchPageURL,"")
    objTitle.Click()
    Set objTitle = Nothing
    Call EnoviaSearch_DynText(objTitleInput,oModel.Common.Title)
  End If
      
'-------------------------------------------------------------------------------------------------------------
      
  If oModel.Description2 <> "" Then
    Set objDesc = objGetObject(OR_EnoviaSearchFindProdData_DescriptionPnl,g_SearchPageURL,"")
    objDesc.Click()
    Set objDesc = Nothing
    Call EnoviaSearch_DynText(objDescInput,oModel.Description2)
  End If
      
'-------------------------------------------------------------------------------------------------------------
        
  If (EnoviaSearch_ValCheck(oModel.Common.State) = True) Then
    Set objState = objGetObject(OR_EnoviaSearchFindProdData_StatePnl,g_SearchPageURL,"")
    objState.Click()
    Set objState = Nothing
    
    Set objStateSelect = objGetObject(OR_EnoviaSearchFindProdData_StateDrp,g_SearchPageURL,2500)
      
    If Not (objStateSelect is Nothing) Then
      objStateSelect.scrollIntoView()
      Call EnoviaSearch_SelectList(objStateSelect,oModel.Common.State)
      Set objStateSelect = Nothing
      Set objStateSubmit = objGetObject(OR_EnoviaSearchFindProdData_StateBtn,g_SearchPageURL,"")
      objStateSubmit.ClickButton()
      Set objStateSubmit = Nothing        
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.Common.State)
    End If
  End If   
      
'-------------------------------------------------------------------------------------------------------------
        
  If oModel.ReleaseDate.SDate <> "" Then
    Set objReleaseDate = objGetObject(OR_EnoviaFindProdData_ReleaseDate,g_SearchPageURL,"")
    Call EnoviaSearch_SetDate(OR_EnoviaFindProdData_ReleaseDate,oModel)
    objReleaseDate.ScrollIntoView()
    objReleaseDate.Click()
    Set objReleaseDate = nothing
    Set objReleaseDateDone = objGetObject(OR_EnoviaFindProdData_ReleaseDate_Done,g_SearchPageURL,"")
    objReleaseDateDone.click()
    Set objReleaseDateDone = nothing
  End If
    
'-------------------------------------------------------------------------------------------------------------

  If oModel.EffectiveDate.SDate <> "" Then
    Set objEffectiveDate = objGetObject(OR_EnoviaFindProdData_EffectiveDate,g_SearchPageURL,"")
    Call EnoviaSearch_SetDate(OR_EnoviaFindProdData_EffectiveDate,oModel)
    objEffectiveDate.Click()
    Set objEffectiveDateDone = objGetObject(OR_EnoviaFindProdData_EffectiveDate_Done,g_SearchPageURL,"")
    objEffectiveDateDone.click()
    Set objEffectiveDateDone = nothing
  End If

'-------------------------------------------------------------------------------------------------------------  
      
  If oModel.ExpirationDate.SDate <> "" Then
    Set objExpirationDate = objGetObject(OR_EnoviaFindProdData_ExpirationDate,g_SearchPageURL,"")
    Call EnoviaSearch_SetDate(OR_EnoviaFindProdData_ExpirationDate,oModel)
    objExpirationDate.Click()
    Set objExpirationDateDone = objGetObject(OR_EnoviaFindProdData_ExpirationDate_Done,g_SearchPageURL,"")
    objExpirationDateDone.click()
    Set objExpirationDateDone = nothing
  End If

'-------------------------------------------------------------------------------------------------------------  
  
  If oModel.ObsoleteDate.SDate <> "" Then
    Set objObsoleteDate = objGetObject(OR_EnoviaFindProdData_ObsoleteDate,g_SearchPageURL,"")
    Call EnoviaSearch_SetDate(OR_EnoviaFindProdData_ObsoleteDate,oModel)
    objObsoleteDate.Click()
    Set objObsoleteDateDone = objGetObject(OR_EnoviaFindProdData_ObsoleteDate_Done,g_SearchPageURL,"")
    objObsoleteDateDone.click()
    Set objObsoleteDateDone = nothing
  End If
    
'-------------------------------------------------------------------------------------------------------------  
      
  If (EnoviaSearch_ValCheck(oModel.SecCatClassification) = True) Then
    Set objSecCatCla = objGetObject(OR_EnoviaSearchFindProdData_SecCatClaPnl,g_SearchPageURL,"")
    objSecCatCla.Click()
    Set objSecCatCla = Nothing
      
    Set objSecCatClaSelect = objGetObject(OR_EnoviaSearchFindProdData_SecCatClaDrp,g_SearchPageURL,2500)
      
    If Not (objSecCatClaSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objSecCatClaSelect,oModel.SecCatClassification)
      Set objSecCatClaSelect = Nothing
      Set objSecCatClaSubmit = objGetObject(OR_EnoviaSearchFindProdData_SecCatClaBtn,g_SearchPageURL,"")
      objSecCatClaSubmit.ClickButton()
      Set objSecCatClaSubmit = Nothing
    Else
     Call EnoviaSearch_DynText(objDynText,oModel.SecCatClassification)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------
      
  If (EnoviaSearch_ValCheck(oModel.Organization) = True) Then     
    Set objOrganization = objGetObject(OR_EnoviaSearchFindProdData_OrganizationPnl,g_SearchPageURL,"")
    objOrganization.Click()
    Set objOrganization = Nothing
           
    Set objOrganizationSelect = objGetObject(OR_EnoviaSearchFindProdData_OrganizationDrp,g_SearchPageURL,2500)
      
    If Not (objOrganizationSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objOrganizationSelect,oModel.Organization)
      Set objOrganizationSelect = Nothing
      Set objOrganizationSubmit = objGetObject(OR_EnoviaSearchFindProdData_OrganizationBtn,g_SearchPageURL,"")
      objOrganizationSubmit.ClickButton()
      Set objOrganizationSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.Organization)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------
  
  If (EnoviaSearch_ValCheck(oModel.Segment) = True) Then 
    Set objSegment = objGetObject(OR_EnoviaSearchFindProdData_SegmentPnl,g_SearchPageURL,"")
    objSegment.Click()
    Set objSegment = Nothing
      
    Set objSegmentSelect = objGetObject(OR_EnoviaSearchFindProdData_SegmentDrp,g_SearchPageURL,2500)
      
    If Not (objSegmentSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objSegmentSelect,oModel.Segment)
      Set objSegmentSelect = Nothing
      Set objSegmentSubmit = objGetObject(OR_EnoviaSearchFindProdData_SegmentBtn,g_SearchPageURL,"")
      objSegmentSubmit.ClickButton()
      Set objSegmentSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.Segment)
    End If
  End If  
  
'-------------------------------------------------------------------------------------------------------------
      
  If (EnoviaSearch_ValCheck(oModel.CSSBusinessCategory) = True) Then
    Set objCssBusCat = objGetObject(OR_EnoviaSearchFindProdData_CssBusCatPnl,g_SearchPageURL,"")
    objCssBusCat.Click()
    Set objCssBusCat = Nothing
      
    Set objCssBusCatSelect = objGetObject(OR_EnoviaSearchFindProdData_CssBusCatDrp,g_SearchPageURL,2500)
      
    If Not (objCssBusCatSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objCssBusCatSelect,oModel.CSSBusinessCategory)
      Set objCssBusCatSelect = Nothing
      Set objCssBusCatSubmit = objGetObject(OR_EnoviaSearchFindProdData_CssBusCatBtn,g_SearchPageURL,"")
      objCssBusCatSubmit.ClickButton()
      Set objCssBusCatSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.CSSBusinessCategory)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------
       
  If (EnoviaSearch_ValCheck(oModel.PlantsAuth) = True) Then   
    Set objPlantAut = objGetObject(OR_EnoviaSearchFindProdData_PlantAutPnl,g_SearchPageURL,"")
    objPlantAut.ScrollIntoView()
    objPlantAut.Click()    
    Set objPlantAut = Nothing
      
    Set objPlantAutSelect = objGetObject(OR_EnoviaSearchFindProdData_PlantAutDrp,g_SearchPageURL,2500)
      
    If Not (objPlantAutSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objPlantAutSelect,oModel.PlantsAuth)
      Set objPlantAutSelect = Nothing
      Set objPlantAutSubmit = objGetObject(OR_EnoviaSearchFindProdData_PlantAutBtn,g_SearchPageURL,"")
      objPlantAutSubmit.ClickButton()
      Set objPlantAutSubmit = Nothing
    Else
     Call EnoviaSearch_DynText(objDynText,oModel.PlantsAuth)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------
 
  If (EnoviaSearch_ValCheck(oModel.PlantsAuthToUse) = True) Then  
    Set objPlantAutToUse = objGetObject(OR_EnoviaSearchFindProdData_PlantAutUsePnl,g_SearchPageURL,"")
    objPlantAutToUse.Click()
    Set objPlantAutToUse = Nothing

    Set objPlantAutToUseSelect = objGetObject(OR_EnoviaSearchFindProdData_PlantAutUseDrp,g_SearchPageURL,2500)
      
    If Not (objPlantAutToUseSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objPlantAutToUseSelect,oModel.PlantsAuthToUse)
      Set objPlantAutToUseSelect = Nothing
      Set objPlantAutToUseSubmit = objGetObject(OR_EnoviaSearchFindProdData_PlantAutUseBtn,g_SearchPageURL,"")
      objPlantAutToUseSubmit.ClickButton()
      Set objPlantAutToUseSubmit = Nothing 
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.PlantsAuthToUse)
    End If
  End If  
'-------------------------------------------------------------------------------------------------------------
      
  If (EnoviaSearch_ValCheck(oModel.PlantsAuthToProd) = True) Then
    Set objPlantAutToProduce = objGetObject(OR_EnoviaSearchFindProdData_PlantAutProdPnl,g_SearchPageURL,"")
    objPlantAutToProduce.Click()
    Set objPlantAutToProduce = Nothing
      
    Set objPlantAutToProduceSelect = objGetObject(OR_EnoviaSearchFindProdData_PlantAutProdDrp,g_SearchPageURL,2500)
      
    If Not (objPlantAutToProduceSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objPlantAutToProduceSelect,oModel.PlantsAuthToProd)
      Set objPlantAutToProduceSelect = Nothing
      Set objPlantAutToProduceSubmit = objGetObject(OR_EnoviaSearchFindProdData_PlantAutProdBtn,g_SearchPageURL,"")
      objPlantAutToProduceSubmit.ClickButton()
      Set objPlantAutToProduceSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.PlantsAuthToProd)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------
 
  If (EnoviaSearch_ValCheck(oModel.PlantsActivated) = True) Then
    Set objPlantActive = objGetObject(OR_EnoviaSearchFindProdData_PlantActPnl,g_SearchPageURL,"")
    objPlantActive.Click()
    Set objPlantActive = Nothing
      
    Set objPlantActiveSelect = objGetObject(OR_EnoviaSearchFindProdData_PlantActDrp,g_SearchPageURL,2500)
      
    If Not (objPlantActiveSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objPlantActiveSelect,oModel.PlantsActivated)
      Set objPlantActiveSelect = Nothing      
      Set objPlantActiveSubmit = objGetObject(OR_EnoviaSearchFindProdData_PlantActBtn,g_SearchPageURL,"")
      objPlantActiveSubmit.ClickButton()
      Set objPlantActiveSubmit = Nothing
    Else
     Call EnoviaSearch_DynText(objDynText,oModel.PlantsActivated)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------

  If (EnoviaSearch_ValCheck(oModel.SupplierName) = True) Then
    Set objSuppName = objGetObject(OR_EnoviaSearchFindProdData_SuppNamePnl,g_SearchPageURL,"")
    objSuppName.Click()
    Set objSuppName = Nothing
   
    Set objSuppNameSelect = objGetObject(OR_EnoviaSearchFindProdData_SuppNameDrp,g_SearchPageURL,2500)
      
    If Not (objSuppNameSelect is Nothing) Then      
      Call EnoviaSearch_SelectList(objSuppNameSelect,oModel.SupplierName)
      Set objSuppNameSelect = Nothing
      Set objSuppNameSubmit = objGetObject(OR_EnoviaSearchFindProdData_SuppNameBtn,g_SearchPageURL,"")
      objSuppNameSubmit.ClickButton()
      Set objSuppNameSubmit = Nothing      
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.SupplierName)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------

  If (EnoviaSearch_ValCheck(oModel.Originator) = True) Then               
    Set objOriginator = objGetObject(OR_EnoviaSearchFindProdData_OrgNamePnl,g_SearchPageURL,"")
    objOriginator.Refresh
    objOriginator.ScrollIntoView()
    objOriginator.Click()
    Set objOriginator = Nothing
   
    Set objOriginatorInputSelect = objGetObject(OR_EnoviaSearchFindProdData_OrgNameDrp,g_SearchPageURL,2500)
      
    If Not (objOriginatorInputSelect is Nothing) Then      
      Call EnoviaSearch_SelectList(objOriginatorInputSelect,oModel.Originator)
      Set objOriginatorInputSelect = Nothing
      Set objOriginatorInputSubmit = objGetObject(OR_EnoviaSearchFindProdData_OrgNameBtn,g_SearchPageURL,"")
      objOriginatorInputSubmit.ClickButton()
      Set objOriginatorInputSubmit = Nothing      
    Else      
      Call EnoviaSearch_DynText(objDynText,oModel.Originator)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------
 
  If (EnoviaSearch_ValCheck(oModel.OriginatorOrCoOwner) = True) Then 
      
    Set objOrigCoOwner = objGetObject(OR_EnoviaSearchFindProdData_OrgCoOwnPnl,g_SearchPageURL,"")
    objOrigCoOwner.Click()
    Set objOrigCoOwner = Nothing
      
    Set objOrigCoOwnerSelect = objGetObject(OR_EnoviaSearchFindProdData_OrgCoOwnDrp,g_SearchPageURL,2500)
      
    If Not (objOrigCoOwnerSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objOrigCoOwnerSelect,oModel.OriginatorOrCoOwner)
      Set objOrigCoOwnerSelect = Nothing
      Set objOrigCoOwnerSubmit = objGetObject(OR_EnoviaSearchFindProdData_OrgCoOwnBtn,g_SearchPageURL,"")
      objOrigCoOwnerSubmit.ClickButton()
      Set objOrigCoOwnerSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.OriginatorOrCoOwner)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------

  If (EnoviaSearch_ValCheck(oModel.MaterialGroup) = True) Then 
    Set objMatGrp = objGetObject(OR_EnoviaSearchFindProdData_MatGrpPnl,g_SearchPageURL,"")
    objMatGrp.ScrollIntoView()
    objMatGrp.Click()
    Set objMatGrp = Nothing

    Set objMatGrpSelect = objGetObject(OR_EnoviaSearchFindProdData_MatGrpDrp,g_SearchPageURL,2500)
      
    If Not (objMatGrpSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objMatGrpSelect,oModel.MaterialGroup)
      Set objMatGrpSelect = Nothing
      Set objMatGrpSubmit = objGetObject(OR_EnoviaSearchFindProdData_MatGrpBtn,g_SearchPageURL,"")
      objMatGrpSubmit.ClickButton()
      Set objMatGrpSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.MaterialGroup)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------

  If (EnoviaSearch_ValCheck(oModel.ManufacturingStatus) = True) Then      
    Set objManStat = objGetObject(OR_EnoviaSearchFindProdData_MfgStatPnl,g_SearchPageURL,"")
    objManStat.Click()
    Set objManStat = Nothing
      
    Set objManStatSelect = objGetObject(OR_EnoviaSearchFindProdData_MfgStatDrp,g_SearchPageURL,2500)
      
    If Not (objManStatSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objManStatSelect,oModel.ManufacturingStatus)
      Set objManStatSelect = Nothing
      Set objManStatSubmit = objGetObject(OR_EnoviaSearchFindProdData_MfgStatBtn,g_SearchPageURL,"")
      objManStatSubmit.ClickButton()
      Set objManStatSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.ManufacturingStatus)
    End If
  End If
  
End Function

'##################################################################################################################
'Function Name                : EnoviaFindProdData_ExecuteClass(oModel)
'Description                  : Performing Operations on Fulltext Search Type
'Arguments                    : NA
'Return Value                 : Nothing
'Author                       : Sumana Gottipati
'Creation Date                : 23 & 24 - May -2017
'Special Conditions           : NA                                     
'Revision History             : NA
'Revision Date                : NA
'##################################################################################################################
  

Function EnoviaFindProdData_ExecuteClass(oModel)   

  If (EnoviaSearch_ValCheck(oModel.SClass) = True) Then      

    Set objClass = objGetObject(OR_EnoviaSearchFindProdData_ClassPnl,g_SearchPageURL,"")
    objClass.Click()
    Set objClass = Nothing
      
    Set objClassSelect = objGetObject(OR_EnoviaSearchFindProdData_ClassDrp,g_SearchPageURL,2500)
      
    If Not (objClassSelect is Nothing) Then 
      Call EnoviaSearch_SelectList(objClassSelect,oModel.SClass)
      Set objClassSelect = Nothing
      Set objClassSubmit = objGetObject(OR_EnoviaSearchFindProdData_ClassBtn,g_SearchPageURL,"")
      objClassSubmit.ClickButton()
      Set objClassSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.SClass)
    End If
  End If
  
'-------------------------------------------------------------------------------------------------------------
    
  If (EnoviaSearch_ValCheck(oModel.SubClass) = True) Then
    Set objSubClass = objGetObject(OR_EnoviaSearchFindProdData_SubClassPnl,g_SearchPageURL,"")
    objSubClass.Click()
    Set objSubClass = Nothing
      
    Set objSubClassSelect = objGetObject(OR_EnoviaSearchFindProdData_SubClassDrp,g_SearchPageURL,2500)
      
    If Not (objSubClassSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objSubClassSelect,oModel.SubClass)
      Set objSubClassSelect = Nothing
      Set objSubClassSubmit = objGetObject(OR_EnoviaSearchFindProdData_SubClassBtn,g_SearchPageURL,"")
      objSubClassSubmit.ClickButton()
      Set objSubClassSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.SubClass)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------
 
  If (EnoviaSearch_ValCheck(oModel.ReportedFunction) = True) Then
    Set objRepFunc = objGetObject(OR_EnoviaSearchFindProdData_RepFuncPnl,g_SearchPageURL,"")
    objRepFunc.Click()
    Set objRepFunc = Nothing
  
    Set objRepFuncSelect = objGetObject(OR_EnoviaSearchFindProdData_RepFuncDrp,g_SearchPageURL,2500)
      
    If Not (objRepFuncSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objRepFuncSelect,oModel.ReportedFunction)
      Set objRepFuncSelect = Nothing
      Set objRepFuncSubmit = objGetObject(OR_EnoviaSearchFindProdData_RepFuncBtn,g_SearchPageURL,"")
      objRepFuncSubmit.ClickButton()
      Set objRepFuncSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.ReportedFunction)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------
     
  If (EnoviaSearch_ValCheck(oModel.PackagingMaterialType) = True) Then
    Set objPacMatTyp = objGetObject(OR_EnoviaSearchFindProdData_PacMatTypPnl,g_SearchPageURL,"")
    objPacMatTyp.Click()
    Set objPacMatTyp = Nothing
      
    Set objPacMatTypSelect = objGetObject(OR_EnoviaSearchFindProdData_PacMatTypDrp,g_SearchPageURL,2500)
      
    If Not (objPacMatTypSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objPacMatTypSelect,oModel.PackagingMaterialType)
      Set objPacMatTypSelect = Nothing
      Set objPacMatTypSubmit = objGetObject(OR_EnoviaSearchFindProdData_PacMatTypBtn,g_SearchPageURL,"")
      objPacMatTypSubmit.ClickButton()
      Set objPacMatTypSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.PackagingMaterialType)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------

    If oModel.LocalDescription <> "" Then
      Set objLocDesc = objGetObject(OR_EnoviaSearchFindProdData_LocDesPnl,g_SearchPageURL,"")
      objLocDesc.Click()
      objLocDesc.ScrollIntoView()
      Set objLocDesc = Nothing
      Call EnoviaSearch_DynText(objDynText,oModel.LocalDescription)
    End If
      
'-------------------------------------------------------------------------------------------------------------
      
  If oModel.OtherNames <> "" Then
      Set objOthName = objGetObject(OR_EnoviaSearchFindProdData_OthNamePnl,g_SearchPageURL,"")
      objOthName.Refresh
      objOthName.ScrollIntoView
      objOthName.Click()
      Set objOthName = Nothing
      Call EnoviaSearch_DynText(objDynText,oModel.OtherNames)
  End If
      
'-------------------------------------------------------------------------------------------------------------
      
  If (EnoviaSearch_ValCheck(oModel.IsIntermediate) = True) Then
    Set objIsIntermediate = objGetObject(OR_EnoviaSearchFindProdData_IsIntermedPnl,g_SearchPageURL,"")
    objIsIntermediate.Click()
    Set objIsIntermediate = Nothing
      
    Set objIsInterSelect = objGetObject(OR_EnoviaSearchFindProdData_IsIntermedDrp,g_SearchPageURL,2500)
      
    If Not (objIsInterSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objIsInterSelect,oModel.IsIntermediate)
      Set objIsInterSelect = Nothing
      Set objIsInterSubmit = objGetObject(OR_EnoviaSearchFindProdData_IsIntermedBtn,g_SearchPageURL,"")
      objIsInterSubmit.ClickButton()
      Set objIsInterSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.IsIntermediate)
    End If
  End If
        
'-------------------------------------------------------------------------------------------------------------
     
  If (EnoviaSearch_ValCheck(oModel.ATSImpactedType) = True) Then
  
    'Reset the State field
    Set oStateTxtNode = objGetObject(OR_EnoviaSearch_TC21_State_TxtNode,g_SearchPageURL,"")
    Set oResetImage = oStateTxtNode.FindChild(Array("ObjectType","ObjectIdentifier"),Array("Image","iconActionRefresh_gif"),2)
    oResetImage.Click
    
    Set oStateTxtNode = Nothing
    Set oResetImage = Nothing 
    
    Set objATS = objGetObject(OR_EnoviaSearchFindProdData_ATSTypePnl,g_SearchPageURL,"")
    objATS.Click()
    Set objATS = Nothing
      
    Set objATSSelect = objGetObject(OR_EnoviaSearchFindProdData_ATSTypeDrp,g_SearchPageURL,2500)
      
    If Not (objATSSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objATSSelect,oModel.ATSImpactedType)
      Set objATSSelect = Nothing
      Set objATSSubmit = objGetObject(OR_EnoviaSearchFindProdData_ATSTypeBtn,g_SearchPageURL,"")
      objATSSubmit.ClickButton()
      Set objATSSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.ATSImpactedType)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------

  If (EnoviaSearch_ValCheck(oModel.IsATS) = True) Then
    Set objIsATS = objGetObject(OR_EnoviaSearchFindProdData_IsATSPnl,g_SearchPageURL,"")
    objIsATS.Click()
    Set objIsATS = Nothing

    Set objIsATSSelect = objGetObject(OR_EnoviaSearchFindProdData_IsATSDrp,g_SearchPageURL,2500)
      
    If Not (objIsATSSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objIsATSSelect,oModel.IsATS)
      Set objIsATSSelect = Nothing
      Set objIsATSSubmit = objGetObject(OR_EnoviaSearchFindProdData_IsATSBtn,g_SearchPageURL,"")
      objIsATSSubmit.ClickButton()
      Set objIsATSSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.IsATS)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------
      
  If (EnoviaSearch_ValCheck(oModel.HasATS) = True) Then
    Set objHasATS = objGetObject(OR_EnoviaSearchFindProdData_HasATSPnl,g_SearchPageURL,"")
    objHasATS.Click()
    Set objHasATS = Nothing
      
    Set objHasATSSelect = objGetObject(OR_EnoviaSearchFindProdData_HasATSDrp,g_SearchPageURL,2500)
      
    If Not (objHasATSSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objHasATSSelect,oModel.HasATS)
      Set objHasATSSelect = Nothing
      Set objHasATSSubmit = objGetObject(OR_EnoviaSearchFindProdData_HasATSBtn,g_SearchPageURL,"")
      objHasATSSubmit.ClickButton()
      Set objHasATSSubmit = Nothing 
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.HasATS)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------

  If (EnoviaSearch_ValCheck(oModel.ArtworkConnected) = True) Then
    Set objArtwrkConn = objGetObject(OR_EnoviaSearchFindProdData_ArtWorkConnPnl,g_SearchPageURL,"")
    objArtwrkConn.Click()
    Set objArtwrkConn = Nothing
      
    Set objArtwrkConnSelect = objGetObject(OR_EnoviaSearchFindProdData_ArtWorkConnDrp,g_SearchPageURL,2500)
      
    If Not (objArtwrkConnSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objArtwrkConnSelect,oModel.ArtworkConnected)
      Set objArtwrkConnSelect = Nothing
      Set objArtwrkConnSubmit = objGetObject(OR_EnoviaSearchFindProdData_ArtWorkConnBtn,g_SearchPageURL,"")
      objArtwrkConnSubmit.ClickButton()
      Set objArtwrkConnSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.ArtworkConnected)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------

  If (EnoviaSearch_ValCheck(oModel.Brand) = True) Then
    Set objBrand = objGetObject(OR_EnoviaSearchFindProdData_BrandPnl,g_SearchPageURL,"")
    objBrand.Click()
    Set objBrand = Nothing
   
    Set objBrandSelect = objGetObject(OR_EnoviaSearchFindProdData_BrandDrp,g_SearchPageURL,2500)
      
    If Not (objBrandSelect is Nothing) Then
      If IsArray(oModel.Brand) = True Then 
        objBrandSelect.Multiselect(oModel.Brand)
      Else
        objBrandSelect.ClickItem(oModel.Brand)
      End If
      'Call EnoviaSearch_SelectList(objBrandSelect,oModel.Brand)
      Set objBrandSelect = Nothing
      Set objBrandSubmit = objGetObject(OR_EnoviaSearchFindProdData_BrandBtn,g_SearchPageURL,"")
      objBrandSubmit.ClickButton()
      Set objBrandSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.Brand)
    End If
  End If
      
'-------------------------------------------------------------------------------------------------------------
  
  If (EnoviaSearch_ValCheck(oModel.ProjectSecurityGroup) = True) Then
    Set objPrjSecGrp = objGetObject(OR_EnoviaSearchFindProdData_ProjSecGrpPDPnl,g_SearchPageURL,"")
    objPrjSecGrp.ScrollIntoView()
    objPrjSecGrp.Click()
    Set objobjPrjSecGrp = Nothing
   
    Set objPrjSecGrpSelect = objGetObject(OR_EnoviaSearchFindProdData_ProjSecGrpPDDrp,g_SearchPageURL,2500)
      
      If Not (objPrjSecGrpSelect is Nothing) Then
        Call EnoviaSearch_SelectList(objPrjSecGrpSelect,oModel.ProjectSecurityGroup)
        Set objPrjSecGrpSelect = Nothing
        Set objPrjSecGrpSubmit = objGetObject(OR_EnoviaSearchFindProdData_ProjSecGrpPDBtn,g_SearchPageURL,"")
        objPrjSecGrpSubmit.ClickButton()
        Set objPrjSecGrpSubmit = Nothing
      Else
        Call EnoviaSearch_DynText(objDynText,oModel.ProjectSecurityGroup)
      End If
    End If
    
'-------------------------------------------------------------------------------------------------------------
      
  If (EnoviaSearch_ValCheck(oModel.OwningStandardsOffice) = True) Then 
    Set objOwnStndOff = objGetObject(OR_EnoviaSearchFindProdData_OwnStaOffPnl,g_SearchPageURL,"")
    objOwnStndOff.Refresh
    objOwnStndOff.ScrollIntoView
    objOwnStndOff.Click()
    Set objOwnStndOff = Nothing
      
    Set objOwnStndOffSelect = objGetObject(OR_EnoviaSearchFindProdData_OwnStaOffDrp,g_SearchPageURL,2500)
      
    If Not (objOwnStndOffSelect is Nothing) Then
      Call EnoviaSearch_SelectList(objOwnStndOffSelect,oModel.OwningStandardsOffice)
      Set objOwnStndOffSelect = Nothing
      Set objOwnStndOffSubmit = objGetObject(OR_EnoviaSearchFindProdData_OwnStaOffBtn,g_SearchPageURL,"")
      objOwnStndOffSubmit.ClickButton()
      Set objOwnStndOffSubmit = Nothing
    Else
      Call EnoviaSearch_DynText(objDynText,oModel.OwningStandardsOffice)
    End If 
  End If
      
'-------------------------------------------------------------------------------------------------------------
      
  Set objFindProdDataSearch = objGetObject(OR_EnoviaSearchFindProdData_Search,g_SearchPageURL,"")
  objFindProdDataSearch.Click()
  Set objFindProdDataSearch = Nothing
  
  aqUtils.Delay 5000,"Results loading."
  
End Function  






